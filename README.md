# RLGym2D - 2Då¼ºåŒ–å­¦ä¹ ä»¿çœŸå¹³å°

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

> **Your First Step into Reinforcement Learning**  
> å¼ºåŒ–å­¦ä¹ çš„ç¬¬ä¸€æ­¥ - ä»2Dåˆ°3Dçš„æ¡¥æ¢

ä¸€ä¸ªæ”¯æŒå¤šä»»åŠ¡çš„2Då¼ºåŒ–å­¦ä¹ ä»¿çœŸå¹³å°ï¼Œä½¿ç”¨PPOç®—æ³•è®­ç»ƒæ™ºèƒ½ä½“å®Œæˆå„ç§æ§åˆ¶ä»»åŠ¡ã€‚

## ğŸ¬ **æ¼”ç¤ºè§†é¢‘**

| ä»»åŠ¡ | æ¼”ç¤ºè§†é¢‘ | æè¿° | è®­ç»ƒæ—¶é—´ |
|------|----------|------|----------|
| **å€’ç«‹æ‘†** | ![CartPole](demos/cartpole_demo.mp4) | æ§åˆ¶å°è½¦ä¿æŒæ‘†æ†å¹³è¡¡ | ~5åˆ†é’Ÿ |
| **ç«æŸ´äºº** | ![Walker](demos/walker_demo.mp4) | åè°ƒå››è‚¢è¿›è¡ŒåŒè¶³è¡Œèµ° | ~30åˆ†é’Ÿ |
| **æœºæ¢°è‡‚** | *å¾…å½•åˆ¶* | ç²¾ç¡®åˆ°è¾¾ç›®æ ‡ç‚¹ | ~10åˆ†é’Ÿ |

> ğŸ’¡ **å½•åˆ¶è‡ªå·±çš„æ¼”ç¤ºè§†é¢‘**: 
> ```bash
> # è®­ç»ƒæ¨¡å‹
> python train.py --task cartpole --envs 8
> 
> # å½•åˆ¶æ¼”ç¤ºï¼ˆè‡ªåŠ¨ä¿å­˜åˆ°videos/ç›®å½•ï¼‰
> python play.py --task cartpole --model runs/cartpole_xxx/best_model/best_model.zip --record --episodes 3
> ```

## ğŸ¯ æ”¯æŒçš„ä»»åŠ¡

### 1. æœºæ¢°è‡‚åˆ°è¾¾ç›®æ ‡ï¼ˆarmï¼‰
- **æè¿°**ï¼š2DåŒå…³èŠ‚æœºæ¢°è‡‚å­¦ä¹ åˆ°è¾¾ç›®æ ‡ç‚¹
- **è§‚å¯Ÿç©ºé—´**ï¼š8ç»´ï¼ˆå…³èŠ‚è§’åº¦ã€é€Ÿåº¦ã€ç›®æ ‡ä½ç½®ç­‰ï¼‰
- **åŠ¨ä½œç©ºé—´**ï¼š2ç»´ï¼ˆä¸¤ä¸ªå…³èŠ‚çš„æ‰­çŸ©ï¼‰
- **ç›®æ ‡**ï¼šç²¾ç¡®åˆ°è¾¾ç›®æ ‡ï¼Œè·¯å¾„ä¼˜åŒ–ï¼Œå¹³æ»‘æ§åˆ¶

### 2. ç«æŸ´äººè¡Œèµ°ï¼ˆwalkerï¼‰
- **æè¿°**ï¼š2Dç«æŸ´äººå­¦ä¹ å‘å³è¡Œèµ°å¹¶ä¿æŒå¹³è¡¡
- **è§‚å¯Ÿç©ºé—´**ï¼š14ç»´ï¼ˆå…³èŠ‚è§’åº¦ã€é€Ÿåº¦ã€èº¯å¹²çŠ¶æ€ç­‰ï¼‰
- **åŠ¨ä½œç©ºé—´**ï¼š4ç»´ï¼ˆ4ä¸ªå…³èŠ‚çš„æ‰­çŸ©ï¼‰
- **ç›®æ ‡**ï¼šå‘å³è¡Œèµ°ï¼Œä¿æŒå¹³è¡¡ï¼Œä¸æ‘”å€’

### 3. å€’ç«‹æ‘†å¹³è¡¡ï¼ˆcartpoleï¼‰
- **æè¿°**ï¼šæ§åˆ¶å°è½¦å·¦å³ç§»åŠ¨ï¼Œä¿æŒæ‘†æ†ç›´ç«‹
- **è§‚å¯Ÿç©ºé—´**ï¼š4ç»´ï¼ˆå°è½¦ä½ç½®ã€é€Ÿåº¦ã€æ‘†æ†è§’åº¦ã€è§’é€Ÿåº¦ï¼‰
- **åŠ¨ä½œç©ºé—´**ï¼š1ç»´ï¼ˆæ°´å¹³æ¨åŠ›ï¼‰
- **ç›®æ ‡**ï¼šä¿æŒæ‘†æ†ç›´ç«‹ï¼Œå°è½¦åœ¨è½¨é“ä¸­å¤®
- **ç‰¹è‰²**ï¼šæ”¯æŒå¤šç§æ‰°åŠ¨æµ‹è¯•ï¼ŒéªŒè¯ç­–ç•¥é²æ£’æ€§

## âš¡ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
# æ–¹æ³•1ï¼šä»æºç å®‰è£…
git clone https://github.com/your-username/RLGym2D.git
cd RLGym2D
pip install -e .

# æ–¹æ³•2ï¼šç›´æ¥å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æ–¹æ³•3ï¼šä½¿ç”¨condaç¯å¢ƒ
conda env create -f environment.yml
conda activate rlgym2d
```

### è®­ç»ƒæ¨¡å‹
```bash
# è®­ç»ƒå€’ç«‹æ‘†
python train.py --task cartpole --envs 8

# è®­ç»ƒæœºæ¢°è‡‚
python train.py --task arm --envs 32

# è®­ç»ƒç«æŸ´äºº
python train.py --task walker --envs 16
```

### æ¼”ç¤ºæ¨¡å‹
```bash
# æ¼”ç¤ºå€’ç«‹æ‘†
python play.py --task cartpole --model runs/cartpole_xxx/best_model/best_model.zip

# æ¼”ç¤ºæœºæ¢°è‡‚
python play.py --task arm --model runs/arm_xxx/best_model/best_model.zip

# æ¼”ç¤ºç«æŸ´äºº
python play.py --task walker --model runs/walker_xxx/best_model/best_model.zip
```

### æ‰°åŠ¨æµ‹è¯•ï¼ˆå€’ç«‹æ‘†ï¼‰
```bash
# åŸºæœ¬æ‰°åŠ¨æµ‹è¯•
python play.py --task cartpole --model model.zip --disturbance

# è‡ªå®šä¹‰æ‰°åŠ¨å‚æ•°
python play.py --task cartpole --model model.zip --disturbance --disturbance-force 3.0 --disturbance-prob 0.05 --disturbance-type both

# é«˜é¢‘æ‰°åŠ¨æµ‹è¯•ï¼ˆå®¹æ˜“è§‚å¯Ÿï¼‰
python play.py --task cartpole --model model.zip --disturbance --disturbance-prob 0.1
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
RLGym2D/
â”œâ”€â”€ train.py                    # ç»Ÿä¸€è®­ç»ƒè„šæœ¬
â”œâ”€â”€ play.py                     # ç»Ÿä¸€æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ configs/                    # é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ arm_config.py          # æœºæ¢°è‡‚é…ç½®
â”‚   â”œâ”€â”€ walker_config.py       # ç«æŸ´äººé…ç½®
â”‚   â””â”€â”€ cartpole_config.py     # å€’ç«‹æ‘†é…ç½®
â”œâ”€â”€ envs/                       # ç¯å¢ƒç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ arm/                   # æœºæ¢°è‡‚ç¯å¢ƒ
â”‚   â”œâ”€â”€ walker/                # ç«æŸ´äººç¯å¢ƒ
â”‚   â””â”€â”€ cartpole/              # å€’ç«‹æ‘†ç¯å¢ƒ
â”œâ”€â”€ core/                       # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ base_env.py            # ç¯å¢ƒåŸºç±»
â”‚   â””â”€â”€ base_rewards.py        # å¥–åŠ±å‡½æ•°åŸºç±»
â”œâ”€â”€ legacy/                     # å‘åå…¼å®¹æ–‡ä»¶
â”œâ”€â”€ runs/                       # è®­ç»ƒç»“æœç›®å½•
â””â”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
```

## ğŸ® ä»»åŠ¡è¯¦è§£

### å€’ç«‹æ‘†ï¼ˆCartPoleï¼‰- æ¨èå…¥é—¨

**ç‰©ç†æ¨¡å‹**ï¼š
- å°è½¦ï¼šå¯å·¦å³ç§»åŠ¨ï¼Œè´¨é‡1kg
- æ‘†æ†ï¼šé•¿åº¦2mï¼Œè´¨é‡0.1kgï¼Œé€šè¿‡å…³èŠ‚è¿æ¥åˆ°å°è½¦
- è½¨é“ï¼šé•¿åº¦å¯é…ç½®ï¼ˆé»˜è®¤Â±4mï¼‰

**æ§åˆ¶ç›®æ ‡**ï¼š
- ä¿æŒæ‘†æ†ç›´ç«‹ï¼ˆè§’åº¦ < 12Â°ï¼‰
- å°è½¦ä¿æŒåœ¨è½¨é“ä¸­å¤®
- æŒç»­1000æ­¥ä¸å¤±æ§

**å¥–åŠ±è®¾è®¡**ï¼š
- è§’åº¦å¥–åŠ±ï¼šæ‘†æ†è¶Šç›´ç«‹å¥–åŠ±è¶Šé«˜
- ä½ç½®æƒ©ç½šï¼šå°è½¦åç¦»ä¸­å¿ƒçš„æƒ©ç½š
- è§’é€Ÿåº¦æƒ©ç½šï¼šé˜²æ­¢æ‘†æ†è½¬åœˆ
- å­˜æ´»å¥–åŠ±ï¼šæ¯æ­¥åŸºç¡€å¥–åŠ±

**æ‰°åŠ¨ç±»å‹**ï¼š
- `cart_only`ï¼šä»…æ‰°åŠ¨å°è½¦ï¼ˆé»˜è®¤ï¼‰
- `pole_only`ï¼šä»…æ‰°åŠ¨æ‘†æ†
- `both`ï¼šåŒæ—¶æ‰°åŠ¨å°è½¦å’Œæ‘†æ†

### æœºæ¢°è‡‚ï¼ˆArmï¼‰

**ç‰©ç†æ¨¡å‹**ï¼š
- 2å…³èŠ‚æœºæ¢°è‡‚ï¼Œè¿æ†é•¿åº¦[100, 80]åƒç´ 
- æ”¯æŒé‡åŠ›ä»¿çœŸï¼ˆå¯é€‰ï¼‰
- æ‘©æ“¦å’Œé˜»å°¼

**æ§åˆ¶ç›®æ ‡**ï¼š
- æœ«ç«¯åˆ°è¾¾éšæœºç›®æ ‡ç‚¹
- è·¯å¾„ä¼˜åŒ–
- å¹³æ»‘æ§åˆ¶

**å¥–åŠ±æ¨¡å¼**ï¼š
- `default`ï¼šè·ç¦»å¥–åŠ± + æˆåŠŸå¥–åŠ±
- `smooth`ï¼šæ·»åŠ é€Ÿåº¦å’ŒåŠ¨ä½œæƒ©ç½š
- `efficient`ï¼šæ·»åŠ è¿›åº¦å’Œæ—¶é—´å¥–åŠ±
- `advanced`ï¼šåŒ…å«æ‰€æœ‰ç»„ä»¶

### ç«æŸ´äººï¼ˆWalkerï¼‰

**ç‰©ç†æ¨¡å‹**ï¼š
- 5ä¸ªåˆšä½“ï¼šèº¯å¹²ã€å¤§è…¿Ã—2ã€å°è…¿Ã—2
- 4ä¸ªå…³èŠ‚ï¼šé«‹å…³èŠ‚Ã—2ã€è†å…³èŠ‚Ã—2
- å…³èŠ‚é™åˆ¶å’Œç¢°æ’æ£€æµ‹

**æ§åˆ¶ç›®æ ‡**ï¼š
- å‘å³è¡Œèµ°
- ä¿æŒå¹³è¡¡
- ä¸æ‘”å€’

**å¥–åŠ±è®¾è®¡**ï¼š
- å‰è¿›å¥–åŠ±ï¼ˆä¸»è¦ï¼‰
- å¹³è¡¡å¥–åŠ±
- å­˜æ´»å¥–åŠ±
- åŠ¨ä½œå¹³æ»‘æƒ©ç½š


## ğŸ“ˆ è®­ç»ƒç›‘æ§

### TensorBoard
```bash
tensorboard --logdir=runs/
```

### Weights & Biases
```bash
pip install wandb
wandb login
# åœ¨é…ç½®ä¸­å¯ç”¨W&B
```

å…³é”®æŒ‡æ ‡ï¼š
- `rollout/ep_rew_mean`ï¼šå¹³å‡å¥–åŠ±
- `train/policy_gradient_loss`ï¼šç­–ç•¥æŸå¤±
- `train/value_loss`ï¼šä»·å€¼æŸå¤±
- `eval/mean_reward`ï¼šè¯„ä¼°å¥–åŠ±
- `eval/success_rate`ï¼šæˆåŠŸç‡ï¼ˆä»…æœºæ¢°è‡‚ä»»åŠ¡ï¼‰

## ğŸ”§ é«˜çº§åŠŸèƒ½

### å¥–åŠ±ç³»ç»Ÿ

æ”¯æŒæ¨¡å—åŒ–å¥–åŠ±è®¾è®¡ï¼š
- **åŸºç¡€ç»„ä»¶**ï¼šè·ç¦»å¥–åŠ±ã€æˆåŠŸå¥–åŠ±
- **å¹³æ»‘æ€§ç»„ä»¶**ï¼šé€Ÿåº¦æƒ©ç½šã€åŠ¨ä½œæƒ©ç½š
- **æ•ˆç‡ç»„ä»¶**ï¼šè¿›åº¦å¥–åŠ±ã€æ—¶é—´æ•ˆç‡
- **è‡ªå®šä¹‰ç»„ä»¶**ï¼šç”¨æˆ·è‡ªå®šä¹‰å¥–åŠ±

### æ‰°åŠ¨æµ‹è¯•

å€’ç«‹æ‘†æ”¯æŒå¤šç§æ‰°åŠ¨æµ‹è¯•ï¼š
- **è®­ç»ƒæ—¶æ— æ‰°åŠ¨**ï¼šè·å¾—ç¨³å®šç­–ç•¥
- **æ¼”ç¤ºæ—¶åŠ æ‰°åŠ¨**ï¼šæµ‹è¯•é²æ£’æ€§
- **å¤šç§æ‰°åŠ¨ç±»å‹**ï¼šå°è½¦ã€æ‘†æ†ã€åŒæ—¶
- **å¯è°ƒå‚æ•°**ï¼šåŠ›åº¦ã€é¢‘ç‡ã€ç±»å‹

### æ¨¡å‹ç®¡ç†

- **è‡ªåŠ¨ä¿å­˜**ï¼šæœ€ä½³æ¨¡å‹ã€å®šæœŸcheckpoint
- **æ—¶é—´æˆ³å‘½å**ï¼šé¿å…è¦†ç›–
- **é…ç½®è®°å½•**ï¼šå®Œæ•´çš„è®­ç»ƒé…ç½®
- **æ‘˜è¦ç”Ÿæˆ**ï¼šè®­ç»ƒç»“æœæ€»ç»“

## ğŸš€ æ·»åŠ æ–°ä»»åŠ¡

### æ­¥éª¤1ï¼šåˆ›å»ºç¯å¢ƒ
```bash
mkdir -p envs/new_task
```

### æ­¥éª¤2ï¼šå®ç°ç¯å¢ƒç±»
```python
# envs/new_task/new_task_env.py
import gymnasium as gym

class NewTaskEnv(gym.Env):
    def __init__(self, render_mode=None, config=None):
        # å®ç°ç¯å¢ƒé€»è¾‘
        pass
```

### æ­¥éª¤3ï¼šæ·»åŠ é…ç½®
```python
# configs/new_task_config.py
NEW_TASK_CONFIG = {
    'env_config': {...},
    'ppo_config': {...},
    'training_config': {...},
    'network_config': {...},
}
```

### æ­¥éª¤4ï¼šæ³¨å†Œä»»åŠ¡
```python
# configs/__init__.py
TASK_CONFIGS = {
    'cartpole': CARTPOLE_CONFIG,
    'arm': ARM_CONFIG,
    'walker': WALKER_CONFIG,
    'new_task': NEW_TASK_CONFIG,  # æ·»åŠ 
}
```

### æ­¥éª¤5ï¼šè®­ç»ƒæµ‹è¯•
```bash
python train.py --task new_task
python play.py --task new_task --model runs/new_task_xxx/model
```


## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®æ–°ä»»åŠ¡ã€ç®—æ³•æ”¹è¿›æˆ–bugä¿®å¤ï¼

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ·Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- Stable-Baselines3
- Gymnasium
- PyMunk
- Pygame
- Weights & Biases

---

**å¼€å§‹ä½ çš„å¼ºåŒ–å­¦ä¹ ä¹‹æ—…ï¼** ğŸš€
